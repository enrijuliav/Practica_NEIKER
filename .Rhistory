setwd("~/Documentos/GitHub/Practica_NEIKER")
setwd("~/Documentos/GitHub/Practica_NEIKER")
loaddata <- function(csv) {
# Load data
data <- read.csv(csv, sep = ";")
# Change colnames
colnames(data) <- data[1,]
data <- data[-1,]
# Change decimal separator from , to .
for (name in colnames(data)[-c(1:4)]) {
data[name] <- as.numeric(sub(",",".",data[[name]]))
}
return(data)
}
# Load the data
rawdata <- loaddata("Raw_data/MD5B_rawdata.csv")
# Select the variables for the analysis: Soil type and metabolites
soiltype <- unique(rawdata[["Soil type"]])
metabolites <- colnames(rawdata)[-c(1:4)]
# Initialize an object that will have all the stat results
stats <- rep(NA, 0)
pvalues <- rep(NA, 0)
# Cycle through every soil type and metabolite
for (soil in soiltype) {
for (metabolite in metabolites) {
# Select only the data of our interest
example <- rawdata[rawdata["Soil type"]==soil, c("Treatment",metabolite)]
# ANOVA test
result <- aov(example[[metabolite]] ~ Treatment, data = example)
# Save the general ANOVA pvalue
pvalues <- append(pvalues,summary(result)[[1]]["Pr(>F)"][1,])
# Extract the values for every posible combination of treatments in one set of conditions
stats <- append(stats,TukeyHSD(result)[1])
}
}
# Transform the vector into a matrix and change the row and column names
# for legibiliy and accessibility
stats <- matrix(data = stats, nrow = length(soiltype), ncol = length(metabolites), byrow = TRUE)
pvalues <- matrix(data = pvalues, nrow = length(soiltype), ncol = length(metabolites), byrow = TRUE)
colnames(stats) <- metabolites
rownames(stats) <- soiltype
colnames(pvalues) <- metabolites
rownames(pvalues) <- soiltype
saveRDS(stats, file = "Processed_data/5B_stats.rds")
saveRDS(pvalues, file = "Processed_data/5B_pvalues.rds")
View(stats)
View(pvalues)
pvalues
pvalues>0.05
# Besides, I would say they were not careful enough with their statystical analysis.
# Mainly, because of the number of combinations (6*3=18)
# and the established limit (pvalue = 0.05), there is a high probability at least
# 1 of the significant result is just a false positive.
# In this case, I would apply a simple FDR correction (which is not as restrictive
# as Bonferroni, and would not be useful, but it takes into consideration multiple
# assays).
padj <- round(p.adjust(pvalues, method = "fdr"), digits = 3)
padj < 0.05
saveRDS(padj, file = "Processed_data/5B_padj.rds")
