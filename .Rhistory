##Fig.2B
library(ggplot2)
loaddata <- function(csv) {
# Load data
data <- read.csv(csv, sep = ";")
# Change colnames
colnames(data) <- data[1,]
data <- data[-1,]
# Change decimal separator from , to .
for (name in colnames(data)[-c(1:4)]) {
data[name] <- as.numeric(sub(",",".",data[[name]]))
}
return(data)
}
# Load the data
rawdata <- loaddata("Raw_data/MD5B_rawdata.csv")
# Select the variables for the analysis: Soil type and metabolites
soiltype <- unique(rawdata[["Soil type"]])
setwd("~/Documentos/GitHub/Practica_NEIKER")
# Load the data
rawdata <- loaddata("Raw_data/MD5B_rawdata.csv")
# Select the variables for the analysis: Soil type and metabolites
soiltype <- unique(rawdata[["Soil type"]])
metabolites <- colnames(rawdata)[-c(1:4)]
# Initialize an object that will have all the stat results
stats <- rep(NA, 0)
pvalues <- rep(NA, 0)
# Cycle through every soil type and metabolite
for (soil in soiltype) {
for (metabolite in metabolites) {
# Select only the data of our interest
example <- rawdata[rawdata["Soil type"]==soil, c("Treatment",metabolite)]
# ANOVA test
result <- aov(example[[metabolite]] ~ Treatment, data = example)
# Print the general ANOVA result and significance
print(summary(result))
pvalues <- append(pvalues,summary(result)[[1]]["Pr(>F)"][1,])
# Extract the values for every posible combination of treatments
stats <- append(stats,TukeyHSD(result)[1])
}
}
# Transform the vector into a matrix and change the row and column names
# for legibiliy and accessibility
stats <- matrix(data = stats, nrow = length(soiltype), ncol = length(metabolites), byrow = TRUE)
pvalues <- matrix(data = pvalues, nrow = length(soiltype), ncol = length(metabolites), byrow = TRUE)
colnames(stats) <- metabolites
rownames(stats) <- soiltype
colnames(pvalues) <- metabolites
rownames(pvalues) <- soiltype
pvalues
# Besides, I would say they were not careful enough with their statystical analysis.
# Mainly, because of the number of combinations (6*3=18)
# and the established limit (pvalue = 0.05), there is a high probability at least
# 1 of the significant result is just a false positive.
# In this case, I would apply a simple FDR correction (which is not as restrictive
# as Bonferroni, and would not be useful, but it takes into consideration multiple
# assays).
padj <- round(p.adjust(pvalues, method = "fdr"), digits = 3)
padj < 0.05
##Fig.2B
library(ggplot2)
library(forcats)
library(ggbreak)
rawdata
FA <- ggplot(rawdata, aes(fill=Treatment))
FA
View(rawdata)
FA <- ggplot(rawdata, aes(fill=Treatment), y = Acetate)
FA <- ggplot(rawdata, aes(fill=Treatment), y = Acetate, x = Soil type)
FA <- ggplot(rawdata, aes(fill="Treatment"), y = "Acetate", x = "Soil type")
rawdata$`Soil type`
factor(rawdata$`Soil type`)
rawdata$`Soil type`<-factor(rawdata$`Soil type`)
FA <- ggplot(rawdata, aes(fill=Treatment), y = "Acetate", x = "Soil type")
FA <- ggplot(rawdata, aes(fill=Treatment), y = "Acetate", x = `Soil type`)
FA <- ggplot(rawdata, aes(fill=Treatment), y = Acetate, x = `Soil type`)
FA <- ggplot(rawdata, aes(fill=Treatment), y = rawdata$Acetate, x = rawdata$`Soil type`)
factor(rawdata$Treatment)
rawdata$Treatment <- factor(rawdata$Treatment)
rawdata
rawdata$Replicate <- factor(rawdata$Replicate)
rawdata[1:4]
rawdata[,c(2,3,"Acetate")]
rawdata[,c(2,3,5)]
prueba <- rawdata[,c(2,3,5)]
FA <- ggplot(rawdata, aes(fill=Treatment, y = rawdata$Acetate, x = rawdata$`Soil type`))
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`))
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5)
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(stat="summary",width=0.7,colour = "black",size=0.5)
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5)
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12)
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
FA
A$condictions <- as.factor(A$condictions)
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
FA
A$condictions <- as.factor(A$condictions)
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
geom_rect(aes(xmin=as.numeric(as.factor(`Soil type`))+0.5,xmax=Inf,ymin=(-Inf),ymax=Inf),
fill='white',color='white')
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5)+
FA
A$condictions <- as.factor(A$condictions)
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5)
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge())
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
F
F
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge())
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge())
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Acetate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
metabolites
FA <- ggplot(rawdata, aes(fill=Treatment, y = Propionate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
metabolites
FA <- ggplot(rawdata, aes(fill=Treatment, y = Butyrate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
FA <- ggplot(rawdata, aes(fill=Treatment, y = Butyrate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
metabolites
FA <- ggplot(rawdata, aes(fill=Treatment, y = Lactate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
metabolites
FA <- ggplot(rawdata, aes(fill=Treatment, y = Malate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
metabolites
FA <- ggplot(rawdata, aes(fill=Treatment, y = Succinate, x = `Soil type`)) +
geom_bar(position=position_dodge(1),stat="summary",width=0.7,colour = "black",size=0.5) +
theme_classic(base_size = 12) +
theme(panel.border=element_rect(fill='transparent',size=0.5),
text = element_text(family = "C",size = 18, colour = "black"))+
geom_vline(aes(xintercept=as.numeric(as.factor(`Soil type`))+0.5),linetype=2,cex=2)+
stat_summary(fun.data = 'mean_se', geom = "errorbar", colour = "black",
width = 0.2,position = position_dodge(1))
FA
